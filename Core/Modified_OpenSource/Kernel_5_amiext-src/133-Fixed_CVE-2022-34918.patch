diff -Naur linux_ori/net/netfilter/nf_tables_api.c linux/net/netfilter/nf_tables_api.c
--- linux_ori/net/netfilter/nf_tables_api.c	2023-04-13 20:40:44.381328000 +0800
+++ linux/net/netfilter/nf_tables_api.c	2023-04-14 15:30:10.766852500 +0800
@@ -4505,6 +4505,7 @@
 	struct nft_data data;
 	enum nft_registers dreg;
 	struct nft_trans *trans;
+	u32 dtype;
 	u32 flags = 0;
 	u64 timeout;
 	u64 expiration;
@@ -4604,7 +4605,13 @@
 			goto err2;
 
 		err = -EINVAL;
-		if (set->dtype != NFT_DATA_VERDICT && d2.len != set->dlen)
+
+		if (set->dtype == NFT_DATA_VERDICT)
+			dtype = NFT_DATA_VERDICT;
+		else
+			dtype = NFT_DATA_VALUE;
+
+		if (dtype != d2.type || set->dlen != d2.len)		
 			goto err3;
 
 		dreg = nft_type_to_reg(set->dtype);
