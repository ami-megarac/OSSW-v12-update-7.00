--- uboot_patch060/include/net.h	2022-06-16 14:47:08.109265816 +0800
+++ uboot/include/net.h	2022-06-16 15:12:50.755478142 +0800
@@ -370,6 +370,8 @@
 
 #define IP_HDR_SIZE		(sizeof(struct ip_hdr))
 
+#define IP_MIN_FRAG_DATAGRAM_SIZE	(IP_HDR_SIZE + 8)
+
 /*
  *	Internet Protocol (IP) + UDP header.
  */
--- uboot_patch060/net/net.c	2022-06-16 14:47:08.061265728 +0800
+++ uboot/net/net.c	2022-06-16 15:14:23.678294364 +0800
@@ -910,6 +910,9 @@
 	int offset8, start, len, done = 0;
 	u16 ip_off = ntohs(ip->ip_off);
 
+	if (ip->ip_len < IP_MIN_FRAG_DATAGRAM_SIZE)
+		return NULL;
+
 	/* payload starts after IP header, this fragment is in there */
 	payload = (struct hole *)(pkt_buff + IP_HDR_SIZE);
 	offset8 =  (ip_off & IP_OFFS);
